pipeline { 
    agent any 
    tools { 
        jdk 'JDK-21' 
        maven 'Maven 3.9.9' 
    } 
    stages { 
        stage('Checkout Prod Branch') { 
            steps { 
                echo 'Checking out Prod branch...' 
                git branch: 'Prod', url: 'https://github.com/Ntangsi/brightmind-tech.git' 
            } 
        } 
        stage('Copy Artifact from Qa') { 
            steps { 
                echo 'Copying artifact from Qa environment...' 
                copyArtifacts( 
                    projectName: 'brightmind-tech-multibranch/Qa',  
                    selector: lastSuccessful(), 
                    target: 'target/' 
                ) 
            } 
        } 
        stage('Approval for Production') { 
            steps { 
                echo 'Waiting for production deployment approval...' 
                input message: 'Approve deployment to production?',  
                      ok: 'Deploy to Production', 
                      submitterParameter: 'APPROVER' 
            } 
        } 
        stage('Deploy to Tomcat (Prod)') { 
            steps { 
                echo 'Deploying to Production Tomcat...' 
                script { 
                    def warFile = "target/brightmind-tech.war" 
                    if (fileExists(warFile)) { 
                        deploy adapters: [ 
                            tomcat9( 
                                credentialsId: 'TomcatCreds', 
                                url: 'http://localhost:8084' 
                            ) 
                        ],  
                        contextPath: '/brightmind-tech', 
                        war: warFile 
                    } else { 
                        error "ERROR: WAR file ${warFile} not found! Production deployment 
failed." 
                    } 
                } 
            } 
        } 
    } 
    post { 
        always { 
            echo 'Cleaning up workspace...' 
            deleteDir() 
        } 
        success { 
            echo "Production deployment completed successfully! Approved by: 
${params.APPROVER}" 
        } 
        failure { 
            echo 'Production pipeline failed. Check build logs for details.' 
        } 
    } 
} 